{%- comment -%}
  Featured Collection with New Product Cards
  Uses the product-card-new component with hover quick-add overlay
{%- endcomment -%}

{%- liquid
  assign per_row = section.settings.per_row
  assign product_limit = per_row | times: section.settings.rows
  assign collection = collections[section.settings.home_featured_products]
-%}

{% style %}
  #FeaturedCollectionNew-{{ section.id }} .product-card-new-grid {
    display: grid;
    grid-template-columns: repeat({{ per_row }}, 1fr);
    gap: 2px;
    width: 100%;
  }

  @media only screen and (max-width: 989px) {
    #FeaturedCollectionNew-{{ section.id }} .product-card-new-grid {
      grid-template-columns: repeat(3, 1fr);
    }
  }

  @media only screen and (max-width: 749px) {
    #FeaturedCollectionNew-{{ section.id }} .product-card-new-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media only screen and (max-width: 479px) {
    #FeaturedCollectionNew-{{ section.id }} .product-card-new-grid {
      grid-template-columns: 1fr;
    }
  }
{% endstyle %}

{%- if section.settings.divider -%}<div class="section--divider">{%- endif -%}

<div
  id="FeaturedCollectionNew-{{ section.id }}"
  data-section-id="{{ section.id }}"
  data-section-type="featured-collection-new"
>
  {%- if section.settings.title != blank or section.settings.view_all -%}
    <div class="page-width">
      <div class="section-header">
        <h2 class="section-header__title">
          {% if section.settings.title != blank %}
            {{ section.settings.title }}
          {% endif %}
          {% if section.settings.view_all and section.settings.rows == 1 %}
            <a href="{{ collections[section.settings.home_featured_products].url }}" class="section-header__link">
              {{- 'collections.general.all_of_collection' | t -}}
            </a>
          {% endif %}
        </h2>
      </div>
    </div>
  {% endif %}

  <div class="product-card-new-grid">
    {% if section.settings.home_featured_products == blank
      or collections[section.settings.home_featured_products].empty?
      or collections[section.settings.home_featured_products].products_count == 0
    %}
      {%- for i in (1..product_limit) -%}
        <div class="product-card-new" data-aos="row-of-{{ per_row }}">
          <div class="product-card-new__image-wrapper">
            <div class="product-card-new__image-container">
              <div class="product-card-new__placeholder">
                {% capture current %}{% cycle 1, 2, 3, 4, 5, 6 %}{% endcapture %}
                {{ 'product-' | append: current | placeholder_svg_tag: 'placeholder-svg' }}
              </div>
            </div>
          </div>
          <div class="product-card-new__meta">
            <span class="product-card-new__meta-link">
              <span class="product-card-new__title">{{ 'home_page.onboarding.product_title' | t }}</span>
              <span class="product-card-new__price">$29</span>
            </span>
          </div>
        </div>
      {%- endfor -%}
    {% else %}
      {%- for product in collections[section.settings.home_featured_products].products limit: product_limit -%}
        {%- render 'product-card-new', product: product, collection: collection, per_row: per_row -%}
      {%- endfor -%}
    {% endif %}
  </div>

  {% if section.settings.view_all and section.settings.rows > 1 %}
    <div class="page-width text-center" style="margin-top: 30px;">
      <a href="{{ collections[section.settings.home_featured_products].url }}" class="btn">
        {{- 'collections.general.all_of_collection' | t -}}
      </a>
    </div>
  {% endif %}
</div>

{%- if section.settings.divider -%}</div>{%- endif -%}

{% schema %}
{
  "name": "Collection - New Cards",
  "class": "index-section",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Heading",
      "default": "Featured collection"
    },
    {
      "type": "collection",
      "id": "home_featured_products",
      "label": "Collection"
    },
    {
      "type": "range",
      "id": "per_row",
      "label": "Products per row",
      "default": 4,
      "min": 2,
      "max": 5,
      "step": 1
    },
    {
      "type": "range",
      "id": "rows",
      "label": "Rows",
      "default": 1,
      "min": 1,
      "max": 5,
      "step": 1
    },
    {
      "type": "checkbox",
      "id": "view_all",
      "label": "Show 'View all' link",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "divider",
      "label": "Show section divider",
      "default": false
    }
  ],
  "presets": [
    {
      "name": "Collection - New Cards"
    }
  ],
  "blocks": [],
  "disabled_on": {
    "groups": ["footer", "header", "custom.popups"]
  }
}
{% endschema %}
